{"ast":null,"code":"import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nconst MOUNTING_PHASE = 'mounting';\nconst UNMOUNTING_PHASE = 'unmounting';\nexport default class Action extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      count: 0\n    };\n\n    this.onPerformed = result => {\n      this.props.onPerformed(result);\n    };\n  }\n\n  componentDidMount() {\n    const {\n      params,\n      performingPhase\n    } = this.props;\n\n    if (performingPhase === MOUNTING_PHASE && this.shouldPerform(params)) {\n      this.perform().then(this.onPerformed);\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      count\n    } = this.state;\n    const {\n      isMultiple\n    } = this.props;\n\n    if ((!count || isMultiple) && this.shouldPerform(prevProps.params)) {\n      this.perform().then(this.onPerformed);\n    }\n  }\n\n  componentWillUnmount() {\n    const {\n      params,\n      performingPhase\n    } = this.props;\n\n    if (performingPhase === UNMOUNTING_PHASE && this.shouldPerform(params)) {\n      this.perform().then(this.onPerformed);\n    }\n  }\n\n  shouldPerform(prevParams) {\n    return this.props.shouldPerform(prevParams);\n  }\n\n  perform() {\n    this.increaseCount();\n    return new Promise(resolve => {\n      resolve(this.props.action());\n    });\n  }\n\n  increaseCount() {\n    this.setState(s => ({\n      count: s.count + 1\n    }));\n  }\n\n  render() {\n    return null;\n  }\n\n}\nAction.propTypes = {\n  action: PropTypes.func,\n  params: PropTypes.object,\n  onPerformed: PropTypes.func,\n  shouldPerform: PropTypes.func,\n  isMultiple: PropTypes.bool,\n  performingPhase: PropTypes.oneOf([MOUNTING_PHASE, UNMOUNTING_PHASE])\n};\nAction.defaultProps = {\n  action: () => {},\n  isMultiple: false,\n  onPerformed: () => {},\n  shouldPerform: () => true,\n  performingPhase: MOUNTING_PHASE\n};","map":{"version":3,"sources":["E:/Git/Work/SynodalLegalDedartament3.0/my-app/src/component/Action/Action.js"],"names":["React","Component","PropTypes","MOUNTING_PHASE","UNMOUNTING_PHASE","Action","state","count","onPerformed","result","props","componentDidMount","params","performingPhase","shouldPerform","perform","then","componentDidUpdate","prevProps","isMultiple","componentWillUnmount","prevParams","increaseCount","Promise","resolve","action","setState","s","render","propTypes","func","object","bool","oneOf","defaultProps"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AAEA,OAAOC,SAAP,MAAsB,YAAtB;AAEA,MAAMC,cAAc,GAAG,UAAvB;AACA,MAAMC,gBAAgB,GAAG,YAAzB;AAEA,eAAe,MAAMC,MAAN,SAAqBJ,SAArB,CAA+B;AAAA;AAAA;AAAA,SAkB1CK,KAlB0C,GAkBlC;AACJC,MAAAA,KAAK,EAAE;AADH,KAlBkC;;AAAA,SA+C1CC,WA/C0C,GA+C5BC,MAAM,IAAI;AACpB,WAAKC,KAAL,CAAWF,WAAX,CAAuBC,MAAvB;AACH,KAjDyC;AAAA;;AAsB1CE,EAAAA,iBAAiB,GAAI;AACjB,UAAM;AAAEC,MAAAA,MAAF;AAAUC,MAAAA;AAAV,QAA8B,KAAKH,KAAzC;;AAEA,QAAIG,eAAe,KAAKV,cAApB,IAAsC,KAAKW,aAAL,CAAmBF,MAAnB,CAA1C,EAAsE;AAClE,WAAKG,OAAL,GAAeC,IAAf,CAAoB,KAAKR,WAAzB;AACH;AACJ;;AAEDS,EAAAA,kBAAkB,CAACC,SAAD,EAAY;AAC1B,UAAM;AAAEX,MAAAA;AAAF,QAAY,KAAKD,KAAvB;AACA,UAAM;AAAEa,MAAAA;AAAF,QAAiB,KAAKT,KAA5B;;AAEA,QAAI,CAAC,CAACH,KAAD,IAAUY,UAAX,KAA0B,KAAKL,aAAL,CAAmBI,SAAS,CAACN,MAA7B,CAA9B,EAAoE;AAChE,WAAKG,OAAL,GAAeC,IAAf,CAAoB,KAAKR,WAAzB;AACH;AACJ;;AAEDY,EAAAA,oBAAoB,GAAG;AACnB,UAAM;AAAER,MAAAA,MAAF;AAAUC,MAAAA;AAAV,QAA8B,KAAKH,KAAzC;;AAEA,QAAIG,eAAe,KAAKT,gBAApB,IAAwC,KAAKU,aAAL,CAAmBF,MAAnB,CAA5C,EAAwE;AACpE,WAAKG,OAAL,GAAeC,IAAf,CAAoB,KAAKR,WAAzB;AACH;AACJ;;AAMDM,EAAAA,aAAa,CAAEO,UAAF,EAAc;AACvB,WAAO,KAAKX,KAAL,CAAWI,aAAX,CAAyBO,UAAzB,CAAP;AACH;;AAEDN,EAAAA,OAAO,GAAI;AACP,SAAKO,aAAL;AACA,WAAO,IAAIC,OAAJ,CAAYC,OAAO,IAAI;AAC1BA,MAAAA,OAAO,CAAC,KAAKd,KAAL,CAAWe,MAAX,EAAD,CAAP;AACH,KAFM,CAAP;AAGH;;AAEDH,EAAAA,aAAa,GAAI;AACb,SAAKI,QAAL,CAAcC,CAAC,KAAK;AAAEpB,MAAAA,KAAK,EAAEoB,CAAC,CAACpB,KAAF,GAAU;AAAnB,KAAL,CAAf;AACH;;AAEDqB,EAAAA,MAAM,GAAI;AAAE,WAAO,IAAP;AAAa;;AAlEiB;AAAzBvB,M,CACVwB,S,GAAY;AACfJ,EAAAA,MAAM,EAAEvB,SAAS,CAAC4B,IADH;AAEflB,EAAAA,MAAM,EAAEV,SAAS,CAAC6B,MAFH;AAGfvB,EAAAA,WAAW,EAAEN,SAAS,CAAC4B,IAHR;AAIfhB,EAAAA,aAAa,EAAEZ,SAAS,CAAC4B,IAJV;AAKfX,EAAAA,UAAU,EAAEjB,SAAS,CAAC8B,IALP;AAMfnB,EAAAA,eAAe,EAAEX,SAAS,CAAC+B,KAAV,CAAgB,CAAC9B,cAAD,EAAiBC,gBAAjB,CAAhB;AANF,C;AADFC,M,CAUV6B,Y,GAAe;AAClBT,EAAAA,MAAM,EAAE,MAAM,CAAE,CADE;AAElBN,EAAAA,UAAU,EAAE,KAFM;AAGlBX,EAAAA,WAAW,EAAE,MAAM,CAAE,CAHH;AAIlBM,EAAAA,aAAa,EAAE,MAAM,IAJH;AAKlBD,EAAAA,eAAe,EAAEV;AALC,C","sourcesContent":["import React, { Component } from 'react'\r\n\r\nimport PropTypes from 'prop-types'\r\n\r\nconst MOUNTING_PHASE = 'mounting'\r\nconst UNMOUNTING_PHASE = 'unmounting'\r\n\r\nexport default class Action extends Component {\r\n    static propTypes = {\r\n        action: PropTypes.func,\r\n        params: PropTypes.object,\r\n        onPerformed: PropTypes.func,\r\n        shouldPerform: PropTypes.func,\r\n        isMultiple: PropTypes.bool,\r\n        performingPhase: PropTypes.oneOf([MOUNTING_PHASE, UNMOUNTING_PHASE])\r\n    }\r\n\r\n    static defaultProps = {\r\n        action: () => {},\r\n        isMultiple: false,\r\n        onPerformed: () => {},\r\n        shouldPerform: () => true,\r\n        performingPhase: MOUNTING_PHASE\r\n    }\r\n\r\n    state = {\r\n        count: 0\r\n    }\r\n\r\n    componentDidMount () {\r\n        const { params, performingPhase } = this.props\r\n\r\n        if (performingPhase === MOUNTING_PHASE && this.shouldPerform(params)) {\r\n            this.perform().then(this.onPerformed)\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        const { count } = this.state\r\n        const { isMultiple } = this.props\r\n\r\n        if ((!count || isMultiple) && this.shouldPerform(prevProps.params)) {\r\n            this.perform().then(this.onPerformed)\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        const { params, performingPhase } = this.props\r\n\r\n        if (performingPhase === UNMOUNTING_PHASE && this.shouldPerform(params)) {\r\n            this.perform().then(this.onPerformed)\r\n        }\r\n    }\r\n\r\n    onPerformed = result => {\r\n        this.props.onPerformed(result)\r\n    }\r\n\r\n    shouldPerform (prevParams) {\r\n        return this.props.shouldPerform(prevParams)\r\n    }\r\n\r\n    perform () {\r\n        this.increaseCount()\r\n        return new Promise(resolve => {\r\n            resolve(this.props.action())\r\n        })\r\n    }\r\n\r\n    increaseCount () {\r\n        this.setState(s => ({ count: s.count + 1 }))\r\n    }\r\n\r\n    render () { return null }\r\n}"]},"metadata":{},"sourceType":"module"}